# １.クレジットカード情報をDBに保存するかどうか
　クレジットカード情報を直接データベースに保存することは、セキュリティの観点から非常に危険です。クレジットカード情報は厳重に保護されるべき機密データです。そのため、カード情報をデータベースに保存することは避けるべきです。
　PAY.JPなどの決済サービスでは、クレジットカードのトークン化（tokenization）を使用します。トークン化では、ユーザーが入力したカード情報をPAY.JP側で処理し、サーバー側にはトークン（token）のみが送信されます。このトークンを使って決済を行うため、クレジットカード情報自体を保存する必要はありませんし、保存するべきではありません。

# ２.DBへの保存に関する注意点
決済に関する情報でDBに保存すべきなのは、トークンや取引ID（決済結果の一意の識別子）、決済ステータスなどの最低限の情報のみです。以下のような情報が考えられます。
<br><br>
・トークン（token）は一時的なもので、実際に保存する必要はありません。<br>
・決済が成功した際に返ってくるトランザクションIDや決済ステータスは保存する場合があります。<br><br>
ユーザーのクレジットカード番号や有効期限、セキュリティコードなどの機密情報は絶対に保存しないようにしましょう。

# 3. バリデーションの付与について
orderモデルに対するバリデーションとしては、クレジットカードのトークン以外の入力データ（例：郵便番号、住所、電話番号など）に対しては必須項目としてバリデーションを付与すべきです。これにより、ユーザーが必要な情報をすべて入力しない場合にエラーメッセージを表示することができます。
<br>
例えば、Orderモデルに以下のようなバリデーションを追加します。
```
class Order < ApplicationRecord
  validates :postal_code, :prefecture_id, :city, :address, :phone_number, presence: true
  validates :postal_code, format: { with: /\A\d{3}-\d{4}\z/, message: '郵便番号はハイフンを含めて入力してください' }
  validates :phone_number, format: { with: /\A\d{10,11}\z/, message: '電話番号は10桁または11桁の数字で入力してください' }
end
```

# ４.order_paramsのpermitについて
order_paramsメソッドで許可されているパラメーターの中には、クレジットカード情報は含まれていません。この点は正しいアプローチです。tokenはPAY.JPが生成したトークンで、これを用いて決済を行います。
<br>
order_paramsには、次のようなデータをpermitしています。
<br>
・郵便番号 (:postal_code)<br>
・都道府県 (:prefecture_id)<br>
・市区町村 (:city)<br>
・住所 (:address)<br>
・電話番号 (:phone_number)<br>
この記述に関しては、特に問題ありませんが、priceに関してはorder_paramsではなく、商品情報に基づいて正確に決定すべきです。 
